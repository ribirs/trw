<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>RPG ì¸í„°í˜ì´ìŠ¤</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #111;
      color: #fff;
    }

    #menu-bar {
      display: flex;
      background-color: #333;
      border-bottom: 1px solid #555;
    }

    .menu-button {
      flex: 1;
      padding: 12px;
      text-align: center;
      cursor: pointer;
      background-color: #333;
      border: none;
      color: white;
      font-size: 16px;
    }

    .menu-button:hover {
      background-color: #444;
    }

    #main-container {
      display: flex;
    }

    #stat-window {
      width: 320px;
      background-color: #222;
      padding: 20px;
      box-sizing: border-box;
      height: calc(100vh - 48px);
      overflow-y: auto;
    }

    .content-panel {
      display: none;
      padding: 20px;
      flex: 1;
    }

    .visible {
      display: block !important;
    }

    .stat-item {
      margin: 8px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .stat-buttons {
      display: flex;
      gap: 4px;
    }

    .stat-buttons button {
      font-size: 12px;
      padding: 2px 6px;
      cursor: pointer;
    }

    #toggle-details {
      margin-top: 15px;
      width: 100%;
      padding: 6px;
      background: #444;
      border: none;
      color: #fff;
      cursor: pointer;
    }

    #gold-display {
      margin-top: 10px;
      font-weight: bold;
      font-size: 14px;
      text-align: center;
      border-top: 1px solid #555;
      padding-top: 8px;
    }

    .hidden {
      display: none;
    }

    /* ë§ˆì„, ë˜ì „ UI */
    .town-button, .dungeon-button {
      display: block;
      width: 100%;
      margin: 8px 0;
      padding: 10px;
      background-color: #444;
      border: none;
      color: #fff;
      cursor: pointer;
      font-size: 15px;
    }

    #floor-select {
      width: 100%;
      margin: 10px 0;
    }
  </style>
</head>
<body>

  <!-- ë©”ë‰´ ë°” -->
  <div id="menu-bar">
    <button class="menu-button" onclick="showPanel('stat')">ğŸ§ ìŠ¤íƒ¯ì°½</button>
    <button class="menu-button" onclick="showPanel('town')">ğŸ˜ï¸ ë§ˆì„</button>
    <button class="menu-button" onclick="showPanel('dungeon')">ğŸ° ë˜ì „</button>
  </div>

  <!-- ë©”ì¸ UI -->
  <div id="main-container">
    <!-- ì™¼ìª½ ìŠ¤íƒ¯ì°½ -->
    <div id="stat-window" class="content-panel visible">
      <h2>ìŠ¤íƒ¯ ì°½</h2>

      <div id="base-stats">
        <div class="stat-item">Lv: <span id="lv">1</span></div>
        <div class="stat-item">Exp: <span id="exp">0</span> / <span id="expNeeded">20</span></div>
        <div class="stat-item">HP: <span id="hp">20</span></div>
        <div class="stat-item">MP: <span id="mp">5</span></div>
        <div class="stat-item">StatPoint: <span id="statPoint">2</span></div>
        <hr>
        <div id="custom-stats"></div>
      </div>

      <div id="detailed-stats" class="hidden">
        <h3>ìƒì„¸ ìŠ¤íƒ¯</h3>
        <div class="stat-item">ë¬¼ë¦¬ ë°ë¯¸ì§€: <span id="physicalDamage">0</span></div>
        <div class="stat-item">ë§ˆë²• ë°ë¯¸ì§€: <span id="magicDamage">0</span></div>
        <div class="stat-item">ëª…ì¤‘ë¥ : <span id="accuracy">0%</span></div>
        <div class="stat-item">íšŒí”¼ìœ¨: <span id="evasion">0%</span></div>
        <div class="stat-item">ë¬¼ë¦¬ í¬ë¦¬í‹°ì»¬ í™•ë¥ : <span id="critRate">0%</span></div>
        <div class="stat-item">ë§ˆë²• í¬ë¦¬í‹°ì»¬ í™•ë¥ : <span id="magicCritRate">0%</span></div>
        <div class="stat-item">ë¬¼ë¦¬ í¬ë¦¬í‹°ì»¬ ë°ë¯¸ì§€: <span id="critDamage">0%</span></div>
        <div class="stat-item">ë§ˆë²• í¬ë¦¬í‹°ì»¬ ë°ë¯¸ì§€: <span id="magicCritDamage">0%</span></div>
      </div>

      <button id="toggle-details" onclick="toggleDetails()">ìƒì„¸ ìŠ¤íƒ¯ ë³´ê¸°</button>
      <div id="gold-display">Gold: <span id="gold">100</span> G</div>
    </div>

    <!-- ë§ˆì„ í™”ë©´ -->
    <div id="town-panel" class="content-panel">
      <h2>ğŸ˜ï¸ ë§ˆì„</h2>
      <button class="town-button" onclick="openItemShop()">ì•„ì´í…œ êµ¬ë§¤</button>
      <button class="town-button" onclick="openSellShop()">ì•„ì´í…œ íŒë§¤</button>
      <button class="town-button" onclick="useInn()">ì—¬ê´€</button>
    </div>

    <!-- ë˜ì „ í™”ë©´ -->
    <div id="dungeon-panel" class="content-panel">
      <h2>ğŸ° ë˜ì „ ì…ì¥</h2>
      <label for="floor-select">ì…ì¥í•  ì¸µ ì„ íƒ:</label>
      <input type="range" id="floor-select" min="1" max="1" value="1">
      <div>ì„ íƒí•œ ì¸µ: <span id="floor-display">1</span>ì¸µ</div>
      <button class="dungeon-button">ì…ì¥</button>
    </div>
  </div>

  <script>
    const stats = {
      lv: 1,
      exp: 0,
      hp: 20,
      mp: 5,
      statPoint: 2,
      gold: 100,
      str: 0,
      dex: 0,
      int: 0,
      luk: 0,
      con: 0,
      men: 0
    };

    const displayStats = ["str", "dex", "int", "luk", "con", "men"];

    function getExpNeededForLevel(level) {
      const baseExp = 20;
      return Math.floor(baseExp * Math.pow(level, 1.25));
    }

    function calculateDerivedStats() {
      const derived = {
        physicalDamage: 3 + stats.str,
        magicDamage: stats.int * 2,
        accuracy: (60 + stats.dex * 0.25).toFixed(2),
        evasion: (10 + stats.dex * 0.25).toFixed(2),
        critRate: (10 + stats.luk * 0.5).toFixed(2),
        magicCritRate: 0.00,
        critDamage: 0.00,
        magicCritDamage: 0.00,
        maxHp: 20 + stats.str * 2 + stats.con * 10,
        maxMp: 5 + stats.int * 2 + stats.men * 5
      };

      stats.hp = derived.maxHp;
      stats.mp = derived.maxMp;

      document.getElementById('physicalDamage').textContent = derived.physicalDamage;
      document.getElementById('magicDamage').textContent = derived.magicDamage;
      document.getElementById('accuracy').textContent = derived.accuracy + '%';
      document.getElementById('evasion').textContent = derived.evasion + '%';
      document.getElementById('critRate').textContent = derived.critRate + '%';
      document.getElementById('magicCritRate').textContent = derived.magicCritRate + '%';
      document.getElementById('critDamage').textContent = derived.critDamage + '%';
      document.getElementById('magicCritDamage').textContent = derived.magicCritDamage + '%';
    }

    function updateStatWindow() {
      for (let key in stats) {
        const el = document.getElementById(key);
        if (el) el.textContent = stats[key];
      }

      document.getElementById('expNeeded').textContent = getExpNeededForLevel(stats.lv);
      document.getElementById('gold').textContent = stats.gold;
      calculateDerivedStats();
    }

    function createStatControls() {
      const container = document.getElementById('custom-stats');
      container.innerHTML = '';

      displayStats.forEach(stat => {
        const div = document.createElement('div');
        div.className = 'stat-item';

        const label = document.createElement('span');
        label.textContent = stat.toUpperCase() + ':';

        const value = document.createElement('span');
        value.id = stat;
        value.textContent = stats[stat];

        const buttons = document.createElement('div');
        buttons.className = 'stat-buttons';

        const btn1 = document.createElement('button');
        btn1.textContent = '+1';
        btn1.onclick = () => addPoint(stat, 1);

        const btnAll = document.createElement('button');
        btnAll.textContent = 'All';
        btnAll.onclick = () => addPoint(stat, 'all');

        buttons.appendChild(btn1);
        buttons.appendChild(btnAll);

        div.appendChild(label);
        div.appendChild(value);
        div.appendChild(buttons);

        container.appendChild(div);
      });
    }

    function addPoint(stat, amount) {
      if (stats.statPoint <= 0) return;

      if (amount === 'all') {
        stats[stat] += stats.statPoint;
        stats.statPoint = 0;
      } else if (amount === 1 && stats.statPoint >= 1) {
        stats[stat] += 1;
        stats.statPoint -= 1;
      }

      updateStatWindow();
    }

    function toggleDetails() {
      const baseStats = document.getElementById('base-stats');
      const detailedStats = document.getElementById('detailed-stats');
      const button = document.getElementById('toggle-details');

      const isDetailsVisible = !detailedStats.classList.contains('hidden');

      if (isDetailsVisible) {
        baseStats.classList.remove('hidden');
        detailedStats.classList.add('hidden');
        button.textContent = 'ìƒì„¸ ìŠ¤íƒ¯ ë³´ê¸°';
      } else {
        baseStats.classList.add('hidden');
        detailedStats.classList.remove('hidden');
        button.textContent = 'ê¸°ë³¸ ìŠ¤íƒ¯ ë³´ê¸°';
      }
    }

    function showPanel(panel) {
      document.getElementById('stat-window').classList.remove('visible');
      document.getElementById('town-panel').classList.remove('visible');
      document.getElementById('dungeon-panel').classList.remove('visible');

      if (panel === 'stat') {
        document.getElementById('stat-window').classList.add('visible');
      } else if (panel === 'town') {
        document.getElementById('town-panel').classList.add('visible');
      } else if (panel === 'dungeon') {
        document.getElementById('dungeon-panel').classList.add('visible');
      }
    }
    
    function useInn() {
      const cost = stats.lv * 100;
      if (stats.gold < cost) {
        alert(`ì—¬ê´€ì„ ì´ìš©í•˜ë ¤ë©´ ${cost} ê³¨ë“œê°€ í•„ìš”í•©ë‹ˆë‹¤.`);
        return;
      }

      stats.gold -= cost;

      // ìµœëŒ€ HP/MP ì¬ê³„ì‚° í›„ íšŒë³µ
      stats.hp = 20 + stats.str * 2 + stats.con * 10;
      stats.mp = 5 + stats.int * 2 + stats.men * 5;

      alert(`ì—¬ê´€ì—ì„œ íœ´ì‹í–ˆìŠµë‹ˆë‹¤. ${cost} G ì†Œëª¨. HP/MPê°€ ëª¨ë‘ íšŒë³µë˜ì—ˆìŠµë‹ˆë‹¤.`);
      updateStatWindow();
    }

    // ì•„ì´í…œ êµ¬ë§¤/íŒë§¤ëŠ” ì•„ì§ êµ¬í˜„ ì•ˆ ëìœ¼ë¯€ë¡œ ë¹ˆ í•¨ìˆ˜
    function openItemShop() {
      alert("ì•„ì´í…œ êµ¬ë§¤ ìƒì ì€ ì•„ì§ êµ¬í˜„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
    }

    function openSellShop() {
      alert("ì•„ì´í…œ íŒë§¤ ìƒì ì€ ì•„ì§ êµ¬í˜„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
    }

    // ë˜ì „ ì¸µ ìŠ¤í¬ë¡¤
    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('floor-select').addEventListener('input', function () {
        document.getElementById('floor-display').textContent = this.value;
      });

      createStatControls();
      updateStatWindow();
    });
  </script>

</body>
</html>
